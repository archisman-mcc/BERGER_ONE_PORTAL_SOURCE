<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/svg+xml" href="/vite.svg" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BERGER ONE</title>
  <!-- Basic inline styles to improve appearance -->
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }

    .page-titlebar {
      background: white;
      padding: 1rem;
      margin-bottom: 1rem;
      border-left: 8px solid #fa5252;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .page-titlebar h5 {
      margin: 0;
      color: #333;
      font-size: 1.5rem;
      font-weight: 600;
    }

    .loading-container {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 200px;
      background: white;
      border-radius: 8px;
      margin: 1rem;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .spinner {
      width: 40px;
      height: 40px;
      border: 4px solid #f3f3f3;
      border-top: 4px solid #667eea;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-right: 1rem;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    .loading-text {
      color: #666;
      font-size: 1.1rem;
    }

    .dashboard-content {
      background: white;
      border-radius: 8px;
      margin: 1rem;
      padding: 1.5rem;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .stat-card {
      background: #f8f9fa;
      padding: 1.5rem;
      border-radius: 8px;
      border-left: 4px solid #667eea;
    }

    .stat-card h3 {
      margin: 0 0 0.5rem 0;
      color: #333;
      font-size: 1.1rem;
    }

    .stat-card .number {
      font-size: 2rem;
      font-weight: bold;
      color: #667eea;
    }

    .table-container {
      background: white;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th,
    td {
      padding: 0.75rem;
      text-align: left;
      border-bottom: 1px solid #eee;
    }

    th {
      background: #f8f9fa;
      font-weight: 600;
      color: #333;
    }

    .btn {
      background: #667eea;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.9rem;
      margin: 0.25rem;
    }

    .btn:hover {
      background: #5a6fd8;
    }
  </style>
  <!--app-head-->
</head>

<body>
  <div id="root"><!--app-html--></div>
  <script type="module" src="/src/main.tsx"></script>
  <script>
    var isMapplsSDKLoaded = false;
    // Generate Access Token
    function GenerateAccessToken() {
      const client_id = "96dHZVzsAuuSJ0Qp0ys-DrOP1KvimrDe2-tvofJuqzbokcPhqmY9Hx2fJeOfQakOHWJ3kEGJ4EhCsCUpzAGKFA==";
      const client_secret = "lrFxI-iSEg__PG5cj3y2n1ZiLMSf65c3wlsc6imT5V7aH7Kgq5jCAk3Rn8LmIogsIxBxwp24qvYm5udah4og-L7ouGtGdaqh";
      const mapplsUrl = `https://bpilmobile.bergerindia.com/mccapis/mapMyIndia/v1/DynamicTokenGeneration?client_id=${client_id}&client_secret=${client_secret}`;
      // const mappleUrl = "https://bpilmobile.bergerindia.com/mccapis/mapMyIndia/v1/TokenGeneration";
      return new Promise((resolve, reject) => {
        fetch(mapplsUrl, {
          method: "GET",
          headers: {
            Authorization: "Basic 764AFD67-0E12-4B9D-83D8-91CDB467C9E6", // Access Key
          },

        })
          .then(response => response.json())
          .then(data => {
            const parsedData = JSON.parse(data);
            if (parsedData && parsedData.access_token) {
              resolve(parsedData);
            } else {
              reject("Failed to fetch access token");
            }
          })
          .catch(error => {
            reject("Error fetching access token: " + error);
          });
      });
    }

    // Load Mappls SDK with the token
    function loadMapplsSDK(token) {
      // var mapple;
      var script = document.createElement("script");
      script.type = "text/javascript";
      // script.async = true; 
      // script.defer = true;
      script.src = "https://apis.mappls.com/advancedmaps/api/" + token + "/map_sdk?v=3.0&layer=vector";
      script.onload = function () {
        if (mapple) {
          console.warn("Mappls SDK Loaded", token, mapple);
          isMapplsSDKLoaded = true;
        } else {
          // loadMapplsSDK(token);
          console.error("Mappls SDK Load Failed", token);
        }
      };
      script.onerror = function () {
        console.error("Error loading Mappls SDK", token);
      };
      document.head.appendChild(script);
    }

    // Get Mappls Access Token and load SDK
    (function getMapplsAccessToken() {
      console.log("Initiating Mappls Token Generation and SDK Load");
      GenerateAccessToken()
        .then(function (tokenData) {
          console.log("Access token received");
          if (tokenData?.access_token && tokenData?.token_type) {
            // Store token in localStorage
            localStorage.setItem("mapplsTokenType", tokenData.token_type);
            localStorage.setItem("mapplsAccessToken", tokenData.access_token);

            // Load Mappls SDK with the token
            loadMapplsSDK(tokenData.access_token);
          }
        })
        .catch(function (error) {
          console.error("Error:", error);
        });
    })();

    //   window.onload = function () {
    //     getMapplsAccessToken();
    // }
  </script>
</body>

</html>